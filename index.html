<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professor Jeopardy! Manager</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Papa Parse (for CSV) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    </head>
<body class="min-h-screen p-4 sm:p-8">

    <div id="app" class="max-w-7xl mx-auto">
        <h1 id="game-title" class="text-4xl font-extrabold text-yellow-400 mb-6 text-center">Professor Jeopardy!</h1>
        
        <!-- Scoreboard (Always Visible) -->
            <div id="scoreboard" class="flex flex-wrap justify-center gap-4 mb-2">
            <!-- Team Score Cards will be injected here -->
        </div>

        <!-- Advanced Edit Modal -->
        <div id="advanced-edit-modal" class="fixed inset-0 z-50 hidden items-center justify-center modal-overlay transition-opacity">
            <div class="bg-gray-900 p-6 rounded-xl shadow-2xl max-w-3xl w-full mx-4 border-2 border-yellow-500">
                <h3 class="text-2xl font-bold text-yellow-400 mb-4">Advanced Team Editor</h3>
                <p class="text-sm text-gray-300 mb-4">Edit team names (max 32 chars) and their scores. Click Save to apply.</p>
                <div id="advanced-edit-list" class="space-y-3 max-h-72 overflow-auto mb-4">
                    <!-- Team edit rows will be injected here -->
                </div>
                <div class="flex justify-end gap-3">
                    <button id="advancedCancelButton" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg">Cancel</button>
                    <button id="advancedSaveButton" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg">Save Changes</button>
                </div>
            </div>
        </div>

        <!-- Daily Double Modal -->
        <div id="daily-double-modal" class="fixed inset-0 z-50 hidden items-center justify-center modal-overlay transition-opacity">
            <div class="bg-gray-900 p-6 rounded-xl shadow-2xl max-w-lg w-full mx-4 border-4 border-yellow-500">
                <h3 class="text-5xl font-extrabold text-yellow-400 mb-4 text-center animate-pulse">DAILY DOUBLE!</h3>
                <div class="space-y-4">
                    <label class="block">
                        <span class="text-gray-300 font-semibold">1. Select Bidding Team</span>
                        <select id="dailyDoubleTeamSelect" class="mt-1 block w-full rounded-lg bg-gray-700 text-white p-2 border border-gray-600"></select>
                    </label>
                    <label class="block">
                        <span class="text-gray-300 font-semibold">2. Enter Wager</span>
                        <input type="number" id="dailyDoubleWager" placeholder="Enter wager amount..." min="0" class="mt-1 block w-full rounded-lg bg-gray-700 text-white p-2 border border-gray-600" />
                    </label>
                    <button id="revealDailyDoubleClue" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-extrabold text-lg py-3 px-4 rounded-lg transition">Reveal Clue</button>
                </div>
            </div>
        </div>

        <!-- Setup Screen -->
        <div id="setup-screen" class="bg-gray-800 p-6 rounded-xl shadow-2xl space-y-4">
            <h2 class="text-2xl font-bold text-white mb-4">Game Setup</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                <!-- CSV Uploader -->
                <div class="md:col-span-2">
                    <label class="block">
                        <span class="text-gray-300 font-semibold">1. Upload Custom Game Data (CSV)</span>
                        <input type="file" id="csvFile" accept=".csv" class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-yellow-50 file:text-yellow-700 hover:file:bg-yellow-100" />
                    </label>
                </div>

                <!-- Template Download & Default Load -->
                <div class="md:col-span-1 space-y-3">
                    <select id="defaultGameSelect" class="w-full bg-gray-700 text-white font-bold py-2 px-4 rounded-lg transition"></select>
                    <button id="loadDefaultGameButton" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg transition">Load from Library</button>
                    <button id="downloadTemplate" class="w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg transition">Download Template CSV</button>
                </div>
            </div>

            <!-- Number of Teams -->
            <label class="block">
                <span class="text-gray-300 font-semibold">2. Number of Teams (2-10)</span>
                <input type="number" id="numTeams" value="3" min="2" max="10" class="mt-1 block w-full rounded-lg bg-gray-700 text-white p-2 border border-gray-600 focus:ring-yellow-500 focus:border-yellow-500" />
            </label>

            <!-- Load Game State -->
            <div class="pt-4 border-t border-gray-700">
                <h3 class="text-xl text-yellow-400 mb-2">Load Saved Game (Optional)</h3>
                <input type="text" id="loadCodeInput" placeholder="Paste save code here..." class="block w-full rounded-lg bg-gray-700 text-white p-2 border border-gray-600 mb-2" />
                <button id="loadGameButton" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition">Load Game State</button>
            </div>

            <!-- Judge Mode -->
            <div id="judge-mode-container" class="pt-4 border-t border-gray-700 hidden">
                <h3 class="text-xl text-yellow-400 mb-2">Judge Mode</h3>
                <button id="judgeModeButton" class="w-full bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg transition">Enter Judge Mode</button>
            </div>

            <button id="startGameButton" class="w-full bg-yellow-600 hover:bg-yellow-700 text-gray-900 font-extrabold text-lg py-3 px-4 rounded-lg transition" disabled>
                Start Game
            </button>

            <p id="setup-message" class="text-sm text-red-400 mt-2 hidden">Please upload a valid CSV file, or load a default/saved game.</p>
        </div>

        <!-- Save Game Modal -->
        <div id="save-game-modal" class="fixed inset-0 z-50 hidden items-center justify-center modal-overlay transition-opacity">
            <div class="bg-gray-900 p-6 rounded-xl shadow-2xl max-w-2xl w-full mx-4 border-2 border-yellow-500">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-2xl font-bold text-yellow-400">Save Game State</h3>
                    <button id="closeSaveModalButton" class="text-gray-400 hover:text-white text-3xl leading-none">&times;</button>
                </div>
                <p class="text-gray-300 text-sm mb-4">
                    This will generate a long text string that you can use to restore your game from its current position. It saves the questions, scores, and all played tiles.
                </p>
                <input type="text" id="saveCodeDisplay" readonly class="w-full rounded-lg bg-gray-700 text-white p-2 border border-gray-600 text-xs sm:text-sm cursor-pointer" placeholder="Click 'Generate Save Code'"/>
                <button id="generateSaveCodeButton" class="w-full mt-3 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg transition">Generate Save Code</button>
            </div>
        </div>

        <!-- Game Board (Hidden until started) -->
        <div id="game-board" class="hidden grid gap-2" style="grid-template-columns: repeat(var(--num-categories), 1fr);">
            <!-- Categories and Clues will be injected here -->
        </div>

        <!-- Game Controls (hidden until game starts) -->
        <div id="game-controls-container" class="hidden mt-8 flex justify-center gap-4">
            <button id="advancedEditButton" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg transition">Advanced Edit</button>
            <button id="saveGameButton" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded-lg transition">Save Game</button>
            <button id="finishGameButton" class="bg-red-700 hover:bg-red-800 text-white font-bold py-2 px-4 rounded-lg transition">Finish Game</button>
        </div>

        <!-- Clue Modal -->
        <div id="clue-modal" class="fixed inset-0 z-50 hidden items-center justify-center modal-overlay transition-opacity">
            <div class="bg-gray-900 p-8 rounded-xl shadow-2xl max-w-4xl w-full mx-4 border-4 border-yellow-500">
                <div id="clue-content" class="text-center mb-6">
                    <h3 id="clue-value-text" class="text-4xl font-extrabold text-yellow-400 mb-4"></h3>
                    <div id="clue-media" class="media-container my-4">
                        <!-- Media (Image/Video) will be injected here -->
                    </div>
                    <p id="clue-text" class="text-2xl text-white font-semibold"></p>
                    <p id="clue-answer" class="text-2xl text-green-400 mt-6 border-t border-gray-700 pt-4 hidden">
                        CORRECT RESPONSE: <span class="font-bold"></span>
                    </p>
                </div>
                
                <div id="clue-actions" class="mt-4">
                    <div class="flex justify-center mb-4 space-x-4">
                        <button id="revealAnswerButton" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition text-xl shadow-lg">
                            Reveal Answer
                        </button>
                        <button id="passClueButton" class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg transition text-xl shadow-lg">
                            Pass / No Answer
                        </button>
                    </div>

                    <div id="scoring-section" class="pt-6 border-t border-gray-700">
                        <h4 class="text-xl text-yellow-400 font-bold mb-3 text-center">Assign Points (After Answer Revealed)</h4>
                        <div id="team-scoring-buttons" class="grid grid-cols-2 sm:grid-cols-4 gap-3">
                            <!-- Team-specific scoring buttons injected here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Final Standings Screen -->
        <div id="final-standings-screen" class="fixed inset-0 z-50 hidden items-center justify-center modal-overlay transition-opacity">
            <div class="bg-gray-900 p-8 rounded-xl shadow-2xl max-w-2xl w-full mx-4 border-4 border-yellow-500 text-center">
                <h2 class="text-5xl font-extrabold text-yellow-400 mb-6">Final Standings</h2>
                <div id="standings-list" class="space-y-4">
                    <!-- Ranked teams will be injected here -->
                </div>
            </div>
        </div>

        <!-- Judge Mode Clue Modal -->
        <div id="judge-clue-modal" class="fixed inset-0 z-50 hidden items-center justify-center modal-overlay transition-opacity" onclick="this.classList.add('hidden'); this.classList.remove('flex');">
            <div class="bg-gray-900 p-8 rounded-xl shadow-2xl max-w-4xl w-full mx-4 border-4 border-gray-500" onclick="event.stopPropagation();">
                <div id="judge-clue-content" class="text-center mb-6">
                    <h3 id="judge-clue-value-text" class="text-3xl font-extrabold text-gray-400 mb-4"></h3>
                    <div id="judge-clue-media" class="media-container my-4">
                        <!-- Media (Image/Video) will be injected here -->
                    </div>
                    <p id="judge-clue-text" class="text-2xl text-white font-semibold"></p>
                    <p id="judge-clue-answer" class="text-2xl text-green-400 mt-6 border-t border-gray-700 pt-4">
                        CORRECT RESPONSE: <span class="font-bold"></span>
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js" defer></script>
</body>
</html>
